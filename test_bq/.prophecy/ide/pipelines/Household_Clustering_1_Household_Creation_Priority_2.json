{
  "id" : "Household_Clustering_1_Household_Creation_Priority_2",
  "metainfo" : {
    "label" : "Household_Clustering_1_Household_Creation_Priority_2",
    "autoLayout" : false,
    "version" : 1,
    "configuration" : {
      "schema" : {
        "type" : "record",
        "fields" : [ {
          "name" : "username_aka_alxaa2_Quer_1",
          "kind" : {
            "type" : "string",
            "value" : "''"
          }
        }, {
          "name" : "password_aka_alxaa2_Quer_1",
          "kind" : {
            "type" : "string",
            "value" : "''"
          }
        }, {
          "name" : "workflow_name",
          "kind" : {
            "type" : "string",
            "value" : "'Household_Clustering_1_Household_Creation_Priority_2'"
          }
        } ]
      }
    },
    "isTranspiledPipeline" : false,
    "publishDiagnosticMetrics" : true,
    "transpilerType" : "alteryx",
    "processesVsModelFiles" : {
      "27_reject" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Filter_27_reject.sql",
      "12" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_12.sql",
      "8" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Cleanse_11.sql",
      "zKwCG-hYIWgqx_x25-PE3" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Cleanse_11.sql",
      "19" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_19.sql",
      "4" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Unique_4.sql",
      "Summarize_22_y4K4WmQGJj8oDuIPBmxJu" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_22.sql",
      "Summarize_19_LmQkTEIPgfDxxPUoz65Ce" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_19.sql",
      "15" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Filter_17.sql",
      "11" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Cleanse_11.sql",
      "9" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Cleanse_11.sql",
      "22" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_22.sql",
      "26" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_26.sql",
      "14_inner" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_21.sql",
      "Summarize_21_jjotWv0-dMB_Ige9m0TEy" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_21.sql",
      "13" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Filter_13.sql",
      "Summarize_25_P2ruDI_BHOewJklC_qvet" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_25.sql",
      "24" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_24.sql",
      "5" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Unique_4.sql",
      "21" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_21.sql",
      "14_left" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Join_14_left.sql",
      "Filter_27_reject_zTMdCzvyMEuZnmPA8d-xB" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Filter_27_reject.sql",
      "Summarize_26_nxrYRuXZrrHJiVRX4uoSu" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_26.sql",
      "Join_14_left_ceNiJcDF9AXwcI5Xdov8T" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_25.sql",
      "aka_alxaa2_Quer_1_1_Output" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Unique_4.sql",
      "23_inner" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_22.sql",
      "Filter_27_7DAksthQyKtZfqW0jwkuC" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Filter_27.sql",
      "17" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Filter_17.sql",
      "25" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_25.sql",
      "Formula_32_0__WZovEnkdmPdmUeWL_9DB" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Formula_32_0.sql",
      "Filter_13_13_True" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Filter_27.sql",
      "20" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_20.sql",
      "Summarize_24_jSXQrdIqHtakdRHxOBB4L" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_24.sql",
      "27" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Filter_27.sql",
      "Formula_31_0_uQBZJqOr7ZT0FSIa6qvIz" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Formula_31_0.sql",
      "Summarize_12_12_Output" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Filter_13.sql",
      "Summarize_20_umMszwjr7Azzy24MuNIbA" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Summarize_20.sql",
      "5hJZ_5S8_ULGU9U8tXxu_" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Formula_32_0.sql",
      "kbj_P1-55w8eZIhBMcpoJ" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Formula_31_0.sql",
      "2swA5FhFWpHamb-DJJNu4" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Cleanse_11.sql",
      "Filter_17_17_True" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Formula_32_0.sql",
      "3" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Unique_4.sql",
      "Cleanse_11_11_Output26" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Join_14_left.sql",
      "Unique_4_4_Unique" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Formula_31_0.sql",
      "28" : "models/Household_Clustering_1_Household_Creation_Priority_2/Household_Clustering_1_Household_Creation_Priority_2__Cleanse_11.sql"
    }
  },
  "processes" : {
    "27_reject" : {
      "id" : "27_reject",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_27_reject",
        "x" : 2270,
        "y" : 1047,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "(\n  (\n    NOT(\n      (\n        CAST(((STRPOS((coalesce(LOWER(Address), '')), LOWER('suite'))) > 0) AS BOOL)\n        OR CAST(((STRPOS((coalesce(LOWER(Address), '')), LOWER('PO box'))) > 0) AS BOOL)\n      )\n      OR CAST(((STRPOS((coalesce(LOWER(Address), '')), LOWER('state highway'))) > 0) AS BOOL))\n  )\n  OR (\n       (\n         (\n           CAST(((STRPOS((coalesce(LOWER(Address), '')), LOWER('suite'))) > 0) AS BOOL)\n           OR CAST(((STRPOS((coalesce(LOWER(Address), '')), LOWER('PO box'))) > 0) AS BOOL)\n         )\n         OR CAST(((STRPOS((coalesce(LOWER(Address), '')), LOWER('state highway'))) > 0) AS BOOL)\n       ) IS NULL\n     )\n)",
          "_row_id" : null
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "tFY46T-jApFGEWi6aEY4V",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "zTMdCzvyMEuZnmPA8d-xB",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "12" : {
      "id" : "12",
      "component" : "Aggregate",
      "metadata" : {
        "label" : "Summarize_12",
        "x" : 1790,
        "y" : 939,
        "phase" : 0
      },
      "properties" : {
        "aggregate" : [ {
          "expression" : {
            "expression" : "COUNT(DISTINCT MBR_INDV_BE_KEY)",
            "_row_id" : null
          },
          "alias" : "CountDistinct_MBR_INDV_BE_KEY",
          "description" : null,
          "_row_id" : "VWuWJoSJdaaq9_hv-BJP8"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CITY_NM",
          "description" : null,
          "_row_id" : "Pefur2_FRNsJfPBuOoKGX"
        }, {
          "expression" : {
            "expression" : "Address",
            "_row_id" : null
          },
          "alias" : "Address",
          "description" : null,
          "_row_id" : "6-Dt9t1Udxebe0vQ4qrsZ"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ZIP_CD_5",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ZIP_CD_5",
          "description" : null,
          "_row_id" : "Ab0sWJytxdHOqU9-UoC8_"
        }, {
          "expression" : {
            "expression" : "ACTVTY_YR_MO_SK",
            "_row_id" : null
          },
          "alias" : "ACTVTY_YR_MO_SK",
          "description" : null,
          "_row_id" : "aDXJjidXlkp4wy9I0XnHu"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CNTY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CNTY_NM",
          "description" : null,
          "_row_id" : "LbQTt7G_K2s2BQu-DZXA5"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ST_CD",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ST_CD",
          "description" : null,
          "_row_id" : "NYviwjeLRVicMyK1q83Ki"
        } ],
        "allowSelection" : true,
        "condition" : {
          "expression" : "",
          "_row_id" : null
        },
        "activeTab" : "aggregate",
        "columnsSelector" : [ ],
        "groupBy" : [ {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : "S6exHRWNLzpTBjEpLRvDG"
        }, {
          "expression" : {
            "expression" : "Address",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : "RhEj0Q2f4y5SzrVsu0zgG"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ZIP_CD_5",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : "v0ebIE_4Dvd3S7Vm-sRHY"
        }, {
          "expression" : {
            "expression" : "ACTVTY_YR_MO_SK",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : "A5yUYh7WiuGSWlNMwHU3y"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CNTY_NM",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : "AIQZ6H5wB7boBJdhdLQxz"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ST_CD",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : "sRRzJELkkKShTrB8E-zgS"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "12_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "12_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "8" : {
      "id" : "8",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "Sort_8",
        "x" : 890,
        "y" : 651,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "orders" : [ {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_1",
            "_row_id" : null
          },
          "sortType" : "asc",
          "nullsType" : ""
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_2",
            "_row_id" : null
          },
          "sortType" : "asc",
          "nullsType" : ""
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "sortType" : "asc",
          "nullsType" : ""
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "8_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "8_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "zKwCG-hYIWgqx_x25-PE3" : {
      "id" : "zKwCG-hYIWgqx_x25-PE3",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Formula_10_0",
        "x" : 1130,
        "y" : 648,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "CAST((CASE WHEN (MBR_HOME_ADDR_LN_1 IS NULL) THEN '' ELSE MBR_HOME_ADDR_LN_1 END) AS STRING)",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_1",
          "description" : null,
          "_row_id" : "Pt7vDL_r0RZvxKmCFVvsh"
        }, {
          "expression" : {
            "expression" : "CAST((CASE WHEN (MBR_HOME_ADDR_LN_2 IS NULL) THEN '' ELSE MBR_HOME_ADDR_LN_2 END) AS STRING)",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_2",
          "description" : null,
          "_row_id" : "dSphOU3GiFNsyYC6Qv_zx"
        }, {
          "expression" : {
            "expression" : "* EXCEPT(`mbr_home_addr_ln_2`, `mbr_home_addr_ln_1`)",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "DOYhWclmJVN4K0lbcwCj7",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "gZBQ_BtGltV00RDp3rjY7",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "19" : {
      "id" : "19",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Summarize_19",
        "x" : 2030,
        "y" : 1191,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "AVG(CountDistinct_MBR_INDV_BE_KEY)",
            "_row_id" : null
          },
          "alias" : "Avg_CountDistinct_MBR_INDV_BE_KEY",
          "description" : null,
          "_row_id" : "wiHtcx2-_IG-tsY_LEaiU"
        }, {
          "expression" : {
            "expression" : "STDDEV(CountDistinct_MBR_INDV_BE_KEY)",
            "_row_id" : null
          },
          "alias" : "StdDev_CountDistinct_MBR_INDV_BE_KEY",
          "description" : null,
          "_row_id" : "ZmIE39Bys8-yw2ErKL7Qe"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "19_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "LmQkTEIPgfDxxPUoz65Ce",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "4" : {
      "id" : "4",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Unique_4",
        "x" : 770,
        "y" : 543,
        "phase" : 0
      },
      "properties" : {
        "dedupColumns" : [ {
          "expression" : {
            "expression" : "MBR_INDV_BE_KEY",
            "_row_id" : null
          },
          "alias" : "MBR_INDV_BE_KEY",
          "description" : null,
          "_row_id" : "luTLZ4Vw7uAl0uGsWGjFu"
        }, {
          "expression" : {
            "expression" : "ACTVTY_YR_MO_SK",
            "_row_id" : null
          },
          "alias" : "ACTVTY_YR_MO_SK",
          "description" : null,
          "_row_id" : "2HI-IsW1rhqhqxF57y9hX"
        } ],
        "dedupType" : "first"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "4_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "4_Unique",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "6"
    },
    "15" : {
      "id" : "15",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Summarize_15",
        "x" : 2510,
        "y" : 687,
        "phase" : 0
      },
      "properties" : {
        "dedupColumns" : [ {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CITY_NM",
          "description" : null,
          "_row_id" : "4fuEkFSR7d_xSnG91pit6"
        }, {
          "expression" : {
            "expression" : "Address",
            "_row_id" : null
          },
          "alias" : "Address",
          "description" : null,
          "_row_id" : "Wxlb1_7V6oGM4f_bHm7WM"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_2",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_2",
          "description" : null,
          "_row_id" : "1QL300r_ZRj-KTk5c5BdL"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ZIP_CD_5",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ZIP_CD_5",
          "description" : null,
          "_row_id" : "SMJK_JKFv3WMSCXFRmKal"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CNTY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CNTY_NM",
          "description" : null,
          "_row_id" : "11HiBT8XQl_EM-SyvVfKa"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_1",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_1",
          "description" : null,
          "_row_id" : "VQ8XfgrF4Y7YPnfeokcnI"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ST_CD",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ST_CD",
          "description" : null,
          "_row_id" : "kFL87AF0NPk7DMl3vplFa"
        } ],
        "dedupType" : "distinct"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "15_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "15_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "11" : {
      "id" : "11",
      "component" : "DataCleansing",
      "metadata" : {
        "label" : "Cleanse_11",
        "x" : 1550,
        "y" : 651,
        "phase" : 0
      },
      "properties" : {
        "trimWhiteSpace" : true,
        "replaceNullForNumericFields" : true,
        "cleanLetters" : false,
        "replaceNullTextWith" : "",
        "removeRowNullAllCols" : false,
        "replaceNullTextFields" : true,
        "relation_name" : [ "Formula_10_1" ],
        "replaceNullDateWith" : "1970-01-01",
        "columnNames" : [ "MBR_HOME_ADDR_LN_1", "MBR_HOME_ADDR_LN_2", "MBR_HOME_ADDR_CITY_NM", "MBR_HOME_ADDR_ST_CD", "MBR_HOME_ADDR_CNTY_NM", "MBR_HOME_ADDR_ZIP_CD_5", "ACTVTY_YR_MO_SK", "MBR_INDV_BE_KEY", "Address" ],
        "replaceNullTimeFields" : false,
        "_oldMacroProperties" : {
          "macroName" : "DataCleansing",
          "projectName" : "prophecy_basics",
          "parameters" : [ {
            "name" : "relation_name",
            "value" : "[\"Formula_10_1\"]"
          }, {
            "name" : "schema",
            "value" : "[{\"name\": \"Address\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_LN_1\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_LN_2\", \"dataType\": \"String\"}, {\"name\": \"MBR_INDV_BE_KEY\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_CITY_NM\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_ZIP_CD_5\", \"dataType\": \"String\"}, {\"name\": \"ACTVTY_YR_MO_SK\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_CNTY_NM\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_ST_CD\", \"dataType\": \"String\"}]"
          }, {
            "name" : "modifyCase",
            "value" : "keepOriginal"
          }, {
            "name" : "columnNames",
            "value" : "[\"MBR_HOME_ADDR_LN_1\", \"MBR_HOME_ADDR_LN_2\", \"MBR_HOME_ADDR_CITY_NM\", \"MBR_HOME_ADDR_ST_CD\", \"MBR_HOME_ADDR_CNTY_NM\", \"MBR_HOME_ADDR_ZIP_CD_5\", \"ACTVTY_YR_MO_SK\", \"MBR_INDV_BE_KEY\", \"Address\"]"
          }, {
            "name" : "replaceNullTextFields",
            "value" : "true"
          }, {
            "name" : "replaceNullTextWith",
            "value" : ""
          }, {
            "name" : "replaceNullForNumericFields",
            "value" : "true"
          }, {
            "name" : "replaceNullNumericWith",
            "value" : "0"
          }, {
            "name" : "trimWhiteSpace",
            "value" : "true"
          }, {
            "name" : "removeTabsLineBreaksAndDuplicateWhitespace",
            "value" : "true"
          }, {
            "name" : "allWhiteSpace",
            "value" : "false"
          }, {
            "name" : "cleanLetters",
            "value" : "false"
          }, {
            "name" : "cleanPunctuations",
            "value" : "false"
          }, {
            "name" : "cleanNumbers",
            "value" : "false"
          }, {
            "name" : "removeRowNullAllCols",
            "value" : "false"
          }, {
            "name" : "replaceNullDateFields",
            "value" : "false"
          }, {
            "name" : "replaceNullDateWith",
            "value" : "1970-01-01"
          }, {
            "name" : "replaceNullTimeFields",
            "value" : "false"
          }, {
            "name" : "replaceNullTimeWith",
            "value" : "1970-01-01 00:00:00.0"
          } ]
        },
        "replaceNullTimeWith" : "1970-01-01 00:00:00.0",
        "schema" : "[{\"name\": \"Address\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_LN_1\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_LN_2\", \"dataType\": \"String\"}, {\"name\": \"MBR_INDV_BE_KEY\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_CITY_NM\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_ZIP_CD_5\", \"dataType\": \"String\"}, {\"name\": \"ACTVTY_YR_MO_SK\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_CNTY_NM\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_ST_CD\", \"dataType\": \"String\"}]",
        "allWhiteSpace" : false,
        "removeTabsLineBreaksAndDuplicateWhitespace" : true,
        "modifyCase" : "keepOriginal",
        "cleanPunctuations" : false,
        "replaceNullDateFields" : false,
        "cleanNumbers" : false,
        "replaceNullNumericWith" : 0
      },
      "ports" : {
        "inputs" : [ {
          "id" : "11_Input2",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "11_Output26",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29",
      "componentInfo" : {
        "gemId" : "DataCleansing_prophecy_basics",
        "name" : "DataCleansing",
        "projectName" : "prophecy_basics",
        "sourceProjectName" : "prophecy_basics"
      }
    },
    "9" : {
      "id" : "9",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Summarize_9",
        "x" : 650,
        "y" : 612,
        "phase" : 0
      },
      "properties" : {
        "dedupColumns" : [ {
          "expression" : {
            "expression" : "MBR_INDV_BE_KEY",
            "_row_id" : null
          },
          "alias" : "MBR_INDV_BE_KEY",
          "description" : null,
          "_row_id" : "VmGttfyd3djrcOjuhUdxD"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CITY_NM",
          "description" : null,
          "_row_id" : "A978SF6w1AicePpLXKCoW"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_2",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_2",
          "description" : null,
          "_row_id" : "YgAMLOxRv6rphaO8AyxRV"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ZIP_CD_5",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ZIP_CD_5",
          "description" : null,
          "_row_id" : "kAMLjwoY8JAEzvRoGtQrx"
        }, {
          "expression" : {
            "expression" : "ACTVTY_YR_MO_SK",
            "_row_id" : null
          },
          "alias" : "ACTVTY_YR_MO_SK",
          "description" : null,
          "_row_id" : "w2mcgkchnKbZ_G5MEwDN5"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CNTY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CNTY_NM",
          "description" : null,
          "_row_id" : "MKvIDKk_3RHzoLLwUev6C"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_1",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_1",
          "description" : null,
          "_row_id" : "W_f8XAe8gM2qVkCB-uH4p"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ST_CD",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ST_CD",
          "description" : null,
          "_row_id" : "uATSib2LK6K5FMURRpVW2"
        } ],
        "dedupType" : "distinct"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "9_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "9_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "22" : {
      "id" : "22",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Summarize_22",
        "x" : 3470,
        "y" : 399,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "COUNT(DISTINCT MBR_INDV_BE_KEY)",
            "_row_id" : null
          },
          "alias" : "CountDistinct_MBR_INDV_BE_KEY",
          "description" : null,
          "_row_id" : "GwX7QemC3msV7qxvhiWt9"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "22_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "y4K4WmQGJj8oDuIPBmxJu",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "26" : {
      "id" : "26",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Summarize_26",
        "x" : 3230,
        "y" : 183,
        "phase" : 0
      },
      "properties" : {
        "dedupColumns" : [ {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CITY_NM",
          "description" : null,
          "_row_id" : "qcdwhGQ-b8OREnxbN0OYq"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_2",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_2",
          "description" : null,
          "_row_id" : "UgZSYtNRv5G0G4cwAg6o-"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ZIP_CD_5",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ZIP_CD_5",
          "description" : null,
          "_row_id" : "oF4Jl9wuXMou2iHQnYuZq"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CNTY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CNTY_NM",
          "description" : null,
          "_row_id" : "-cscksCT6u6DqG-ZmgFeg"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_1",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_1",
          "description" : null,
          "_row_id" : "DbX0QAKV0YRUwzxX4_iq-"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ST_CD",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ST_CD",
          "description" : null,
          "_row_id" : "4tBRC3VOOtPu79lT2ehNP"
        } ],
        "dedupType" : "distinct"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "26_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "nxrYRuXZrrHJiVRX4uoSu",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "14_inner" : {
      "id" : "14_inner",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_14_inner",
        "x" : 2270,
        "y" : 867,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "expression" : "((((in0.Address = in1.Address) AND (in0.MBR_HOME_ADDR_CITY_NM = in1.MBR_HOME_ADDR_CITY_NM)) AND (in0.MBR_HOME_ADDR_ST_CD = in1.MBR_HOME_ADDR_ST_CD)) AND (in0.MBR_HOME_ADDR_ZIP_CD_5 = in1.MBR_HOME_ADDR_ZIP_CD_5))",
            "_row_id" : null
          },
          "joinType" : "inner",
          "rightAlias" : null
        } ],
        "allowSelection" : false,
        "expressions" : [ {
          "expression" : {
            "expression" : "in0.*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "headAlias" : "in0"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "tCYIgwudjitr4dXZgjtll",
          "slug" : "in0"
        }, {
          "id" : "OJR0Fa1UxWk44ea1dhlRg",
          "slug" : "in1"
        } ],
        "outputs" : [ {
          "id" : "4t6YT1emjXBmq-T0CsBHJ",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "13" : {
      "id" : "13",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_13",
        "x" : 2030,
        "y" : 939,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "(CountDistinct_MBR_INDV_BE_KEY > CAST('8' AS FLOAT64))",
          "_row_id" : null
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "13_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "13_True",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "24" : {
      "id" : "24",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Summarize_24",
        "x" : 50,
        "y" : 183,
        "phase" : 0
      },
      "properties" : {
        "dedupColumns" : [ {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CITY_NM",
          "description" : null,
          "_row_id" : "bxiRqsu6Cg4LZti02u-mn"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_2",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_2",
          "description" : null,
          "_row_id" : "WUPPPAVkZYi64_UQcbrGb"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ZIP_CD_5",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ZIP_CD_5",
          "description" : null,
          "_row_id" : "2VK0-jxKzb6jEqY3fhsSI"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CNTY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CNTY_NM",
          "description" : null,
          "_row_id" : "T7ABKYbmLnqZlyiLoPlW7"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_1",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_1",
          "description" : null,
          "_row_id" : "mfT6UZz1HhqI_-GlnBkDZ"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ST_CD",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ST_CD",
          "description" : null,
          "_row_id" : "MBgdBrpy4T4Sr1ljBkhN6"
        } ],
        "dedupType" : "distinct"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "24_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "jSXQrdIqHtakdRHxOBB4L",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "5" : {
      "id" : "5",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_5",
        "x" : 290,
        "y" : 579,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "((CAST((SUBSTRING( GRP_ID, 1, 2)) AS STRING) <> '65') OR ((SUBSTRING( GRP_ID, 1, 2)) IS NULL))",
          "_row_id" : null
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "5_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "5_True",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "6"
    },
    "21" : {
      "id" : "21",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Summarize_21",
        "x" : 2510,
        "y" : 363,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "COUNT(DISTINCT MBR_INDV_BE_KEY)",
            "_row_id" : null
          },
          "alias" : "CountDistinct_MBR_INDV_BE_KEY",
          "description" : null,
          "_row_id" : "EKrDR9owkziNe7W_ySJHh"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "21_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "jjotWv0-dMB_Ige9m0TEy",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "14_left" : {
      "id" : "14_left",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_14_left",
        "x" : 2270,
        "y" : 507,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "expression" : "((((in0.Address = in1.Address) AND (in0.MBR_HOME_ADDR_CITY_NM = in1.MBR_HOME_ADDR_CITY_NM)) AND (in0.MBR_HOME_ADDR_ST_CD = in1.MBR_HOME_ADDR_ST_CD)) AND (in0.MBR_HOME_ADDR_ZIP_CD_5 = in1.MBR_HOME_ADDR_ZIP_CD_5))",
            "_row_id" : null
          },
          "joinType" : "anti",
          "rightAlias" : null
        } ],
        "allowSelection" : false,
        "expressions" : [ {
          "expression" : {
            "expression" : "in0.*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "headAlias" : "in0"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "rqCI6Y5eAMGqk48Ay356W",
          "slug" : "in0"
        }, {
          "id" : "QDJfzUyrzRq6W31SPmk1G",
          "slug" : "in1"
        } ],
        "outputs" : [ {
          "id" : "ceNiJcDF9AXwcI5Xdov8T",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "23_inner" : {
      "id" : "23_inner",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_23_inner",
        "x" : 3230,
        "y" : 615,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "expression" : "(((((in0.Address = in1.Address) AND (in0.MBR_HOME_ADDR_CITY_NM = in1.MBR_HOME_ADDR_CITY_NM)) AND (in0.MBR_HOME_ADDR_ST_CD = in1.MBR_HOME_ADDR_ST_CD)) AND (in0.MBR_HOME_ADDR_CNTY_NM = in1.MBR_HOME_ADDR_CNTY_NM)) AND (in0.MBR_HOME_ADDR_ZIP_CD_5 = in1.MBR_HOME_ADDR_ZIP_CD_5))",
            "_row_id" : null
          },
          "joinType" : "inner",
          "rightAlias" : null
        } ],
        "allowSelection" : false,
        "expressions" : [ {
          "expression" : {
            "expression" : "in1.MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "alias" : "Right_MBR_HOME_ADDR_CITY_NM",
          "description" : null,
          "_row_id" : "3IcAx0pvlD5DMpJ--BX5C"
        }, {
          "expression" : {
            "expression" : "in1.MBR_HOME_ADDR_ST_CD",
            "_row_id" : null
          },
          "alias" : "Right_MBR_HOME_ADDR_ST_CD",
          "description" : null,
          "_row_id" : "H1V8g6aHBCZXn8E3B0esj"
        }, {
          "expression" : {
            "expression" : "in1.MBR_HOME_ADDR_CNTY_NM",
            "_row_id" : null
          },
          "alias" : "Right_MBR_HOME_ADDR_CNTY_NM",
          "description" : null,
          "_row_id" : "smgSaxYYfj7gFM1O90a4w"
        }, {
          "expression" : {
            "expression" : "in1.MBR_HOME_ADDR_ZIP_CD_5",
            "_row_id" : null
          },
          "alias" : "Right_MBR_HOME_ADDR_ZIP_CD_5",
          "description" : null,
          "_row_id" : "JKY9oUGQDkkbc3Pa9MUKG"
        }, {
          "expression" : {
            "expression" : "in1.Address",
            "_row_id" : null
          },
          "alias" : "Right_Address",
          "description" : null,
          "_row_id" : "myzOUXFFwD21_8XM4XWzt"
        }, {
          "expression" : {
            "expression" : "in1.MBR_HOME_ADDR_LN_1",
            "_row_id" : null
          },
          "alias" : "Right_MBR_HOME_ADDR_LN_1",
          "description" : null,
          "_row_id" : "md-VvMmgFFrGrRX8kn9rU"
        }, {
          "expression" : {
            "expression" : "in1.MBR_HOME_ADDR_LN_2",
            "_row_id" : null
          },
          "alias" : "Right_MBR_HOME_ADDR_LN_2",
          "description" : null,
          "_row_id" : "T7BrT7HHC_gunuYHaUjsC"
        }, {
          "expression" : {
            "expression" : "in0.*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "headAlias" : "in0"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "xEYbLxacaGZp0QkPLJI54",
          "slug" : "in0"
        }, {
          "id" : "-qL1gljMRQiyV58-P1P-d",
          "slug" : "in1"
        } ],
        "outputs" : [ {
          "id" : "10FgLhc3upH4qjJp36TMf",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "6" : {
      "id" : "6",
      "component" : "VisualGroup",
      "metadata" : {
        "label" : "Step1",
        "x" : 0,
        "y" : 36,
        "height" : 1107,
        "width" : 1492,
        "phase" : 0
      },
      "properties" : {
        "isCollapsed" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ]
      }
    },
    "1" : {
      "id" : "1",
      "component" : "OrchestrationSource",
      "kind" : "OracleSource",
      "metadata" : {
        "label" : "aka_alxaa2_Quer_1",
        "x" : 50,
        "y" : 579,
        "phase" : 0
      },
      "properties" : {
        "connector" : {
          "kind" : "oracle",
          "id" : "transpiled_connection",
          "properties" : {
            "database" : "dbName",
            "server" : "aka:5e5e7e6749b7fb13a082f9a7",
            "username" : "${username_aka_alxaa2_Quer_1}",
            "id" : "transpiled_connection",
            "port" : "1521",
            "password" : {
              "kind" : "prophecy",
              "properties" : {
                "name" : "transpiled_secret",
                "value" : "transpiled_secret"
              },
              "subKind" : "text",
              "type" : "secret"
            }
          },
          "type" : "connector"
        },
        "properties" : {
          "pathSelection" : "warehouseQuery",
          "tableFullName" : {
            "schema" : "schema",
            "name" : "aka_alxaa2_Quer_1"
          },
          "warehouseQuery" : {
            "query" : "select\n\tm.mbr_indv_be_key,\n\trcst.mbr_sk,\n\tm.sub_id,\n\trcst.actvty_yr_mo_sk,\n\tm.mbr_relshp_cd,\n\tm.mbr_first_nm,\n\tm.mbr_last_nm,\n\tm.mbr_home_addr_ln_1,\n\tm.mbr_home_addr_ln_2,\n\tm.mbr_home_addr_city_nm,\n\tm.mbr_home_addr_st_cd,\n\tm.mbr_home_addr_cnty_nm,\n\tm.mbr_home_addr_zip_cd_5,\n\trcst.grp_id,\n\trcst.mbr_age_at_actvty_yr_mo,\n\tcase\n\t\twhen p.exprnc_cat_cd = 'FEP' then 1\n\t\telse 0\n\tend as FEP_IN,\n\tcase\n\t\twhen rcst.prod_bill_cmpnt_cov_cat_cd = 'DNTL' then 2\n\t\twhen rcst.prod_bill_cmpnt_cov_cat_cd = 'MED' then 1\n\t\twhen rcst.prod_bill_cmpnt_cov_cat_cd = 'LIFE' then 3\n\t\telse 4\n\tend as prod_rank\n\n\nfrom\n\tprod.mbr_rcst_ct_f rcst\n\tinner join\n\t\tprod.mbr_d m on m.mbr_sk = rcst.mbr_sk\n\tinner join\n\t\tprod.prod_d p on p.prod_sk = rcst.prod_sk\n\tinner join\n\t\tprod.yr_mo_d yr_mo on yr_mo.yr_mo_sk = rcst.actvty_yr_mo_sk\n\nwhere\n\tm.mbr_indv_be_key != '0'\n\tand yr_mo.first_dt_of_mo >= char(current date - 15 month,iso)\n\tand yr_mo.first_dt_of_mo < char(current date - 1 month, iso)\n\tand m.mbr_relshp_cd in ('SUB','SPOUSE','DPNDT')\n\tand m.host_mbr_in = 'N'\n\t--Plan information \n\tand p.prod_sh_nm_dlvry_meth_cd in ('EPO','HPN','PPO', 'HMO','TRAD')\n\t--Group exclusions\n\tand left(rcst.grp_id, 2) != '65'"
          }
        },
        "format" : {
          "kind" : "oracle",
          "category" : "table",
          "properties" : {
            "kind" : "oracle",
            "schema" : {
              "entityType" : "",
              "providerType" : "BigQuery",
              "fields" : [ {
                "name" : "MBR_INDV_BE_KEY",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "SUB_ID",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "MBR_SK",
                "dataType" : {
                  "type" : "Numeric"
                }
              }, {
                "name" : "MBR_HOME_ADDR_CITY_NM",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "MBR_FIRST_NM",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "MBR_HOME_ADDR_LN_2",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "MBR_HOME_ADDR_ZIP_CD_5",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "GRP_ID",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "ACTVTY_YR_MO_SK",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "FEP_IN",
                "dataType" : {
                  "type" : "Numeric"
                }
              }, {
                "name" : "MBR_HOME_ADDR_CNTY_NM",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "MBR_HOME_ADDR_LN_1",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "MBR_LAST_NM",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "MBR_RELSHP_CD",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "MBR_AGE_AT_ACTVTY_YR_MO",
                "dataType" : {
                  "type" : "String"
                }
              }, {
                "name" : "PROD_RANK",
                "dataType" : {
                  "type" : "Numeric"
                }
              }, {
                "name" : "MBR_HOME_ADDR_ST_CD",
                "dataType" : {
                  "type" : "String"
                }
              } ]
            }
          }
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "1_Output",
          "slug" : "out0"
        } ]
      },
      "parent" : "6"
    },
    "17" : {
      "id" : "17",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_17",
        "x" : 2750,
        "y" : 687,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "(NOT CAST(((STRPOS(Address, 'po box')) > 0) AS BOOL))",
          "_row_id" : null
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "17_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "17_True",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "25" : {
      "id" : "25",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Summarize_25",
        "x" : 2510,
        "y" : 147,
        "phase" : 0
      },
      "properties" : {
        "dedupColumns" : [ {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CITY_NM",
          "description" : null,
          "_row_id" : "qtVB2em4gQA-P902GIo1U"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_2",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_2",
          "description" : null,
          "_row_id" : "4siqkLd_j2-Hy9qOcE11Q"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ZIP_CD_5",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ZIP_CD_5",
          "description" : null,
          "_row_id" : "K1qe7uC8wq6i9OlpbXJv1"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CNTY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CNTY_NM",
          "description" : null,
          "_row_id" : "CsKoqZlfe0xvxHXdF0pqk"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_1",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_1",
          "description" : null,
          "_row_id" : "8RMAIVs8zlBkGBNmnVCsh"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ST_CD",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ST_CD",
          "description" : null,
          "_row_id" : "IbWXz6XLWMccOppS2UXOv"
        } ],
        "dedupType" : "distinct"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "25_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "P2ruDI_BHOewJklC_qvet",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "20" : {
      "id" : "20",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Summarize_20",
        "x" : 50,
        "y" : 363,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "COUNT(DISTINCT MBR_INDV_BE_KEY)",
            "_row_id" : null
          },
          "alias" : "CountDistinct_MBR_INDV_BE_KEY",
          "description" : null,
          "_row_id" : "WXQ4_btuA5cZl5LbZA2Yy"
        }, {
          "expression" : {
            "expression" : "COUNT(DISTINCT SUB_ID)",
            "_row_id" : null
          },
          "alias" : "CountDistinct_SUB_ID",
          "description" : null,
          "_row_id" : "2ZRbSgMkmfmuHDb4qywZm"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "20_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "umMszwjr7Azzy24MuNIbA",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "27" : {
      "id" : "27",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_27",
        "x" : 2270,
        "y" : 1047,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "((CAST(((STRPOS((coalesce(LOWER(Address), '')), LOWER('suite'))) > 0) AS BOOL) OR CAST(((STRPOS((coalesce(LOWER(Address), '')), LOWER('PO box'))) > 0) AS BOOL)) OR CAST(((STRPOS((coalesce(LOWER(Address), '')), LOWER('state highway'))) > 0) AS BOOL))",
          "_row_id" : null
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "27_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "7DAksthQyKtZfqW0jwkuC",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "2" : {
      "id" : "2",
      "component" : "OrchestrationTarget",
      "kind" : "SFTPTarget",
      "metadata" : {
        "label" : "recast_cache_cs_2",
        "x" : 1250,
        "y" : 147,
        "phase" : 0
      },
      "properties" : {
        "compression" : {
          "kind" : "uncompressed"
        },
        "connector" : {
          "id" : "transpiled_connection",
          "kind" : "sftp",
          "properties" : {
            "authMethod" : "password",
            "username" : "transpiled_username",
            "host" : "sftp.prophecy.io",
            "id" : "transpiled_connection",
            "port" : 22,
            "password" : {
              "kind" : "prophecy",
              "properties" : {
                "name" : "transpiled_secret",
                "value" : "transpiled_secret"
              },
              "subKind" : "text",
              "type" : "secret"
            }
          },
          "type" : "connector"
        },
        "format" : {
          "kind" : "csv",
          "properties" : { }
        },
        "properties" : {
          "filePath" : "\\\\corpdata\\files\\library\\library\\Alteryx\\Advanced Analytics\\Call Model\\Households\\Cache\\recast_cache.csv"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "2_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "oElsCxYxrYy48xiT947xM",
          "slug" : "out0"
        } ]
      },
      "parent" : "6"
    },
    "5hJZ_5S8_ULGU9U8tXxu_" : {
      "id" : "5hJZ_5S8_ULGU9U8tXxu_",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Formula_32_0",
        "x" : 2990,
        "y" : 1227,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "CAST((CONCAT('_', (SUBSTRING( CAST(CAST(CURRENT_DATE AS STRING) AS string), 1, 7)))) AS string)",
            "_row_id" : null
          },
          "alias" : "variabledate",
          "description" : null,
          "_row_id" : "QcAs9-SZhEHASuIP7kd91"
        }, {
          "expression" : {
            "expression" : "*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "SuR-J6AFdoPkagC2cqZW0",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "_WZovEnkdmPdmUeWL_9DB",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "18" : {
      "id" : "18",
      "component" : "OrchestrationTarget",
      "kind" : "SFTPTarget",
      "metadata" : {
        "label" : "address_for_geo_18",
        "x" : 3470,
        "y" : 1227,
        "phase" : 0
      },
      "properties" : {
        "compression" : {
          "kind" : "uncompressed"
        },
        "connector" : {
          "id" : "transpiled_connection",
          "kind" : "sftp",
          "properties" : {
            "authMethod" : "password",
            "username" : "transpiled_username",
            "host" : "sftp.prophecy.io",
            "id" : "transpiled_connection",
            "port" : 22,
            "password" : {
              "kind" : "prophecy",
              "properties" : {
                "name" : "transpiled_secret",
                "value" : "transpiled_secret"
              },
              "subKind" : "text",
              "type" : "secret"
            }
          },
          "type" : "connector"
        },
        "format" : {
          "kind" : "csv",
          "properties" : { }
        },
        "properties" : {
          "filePath" : "\\\\corpdata\\files\\library\\library\\Alteryx\\Advanced Analytics\\Call Model\\Households\\Cache\\address_for_geoencoding.csv"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "18_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "cwfD7XYBrNP7kAEQw5zFg",
          "slug" : "out0"
        } ]
      },
      "parent" : "29"
    },
    "kbj_P1-55w8eZIhBMcpoJ" : {
      "id" : "kbj_P1-55w8eZIhBMcpoJ",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Formula_31_0",
        "x" : 1010,
        "y" : 147,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "CAST((CONCAT('_', (SUBSTRING( CAST(CAST(CURRENT_DATE AS STRING) AS string), 1, 7)))) AS string)",
            "_row_id" : null
          },
          "alias" : "variabledate",
          "description" : null,
          "_row_id" : "KpevBctpmiZE6Mv-GZosi"
        }, {
          "expression" : {
            "expression" : "*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "I4T_n8y3DbrfZA-Fjke7V",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "uQBZJqOr7ZT0FSIa6qvIz",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "6"
    },
    "2swA5FhFWpHamb-DJJNu4" : {
      "id" : "2swA5FhFWpHamb-DJJNu4",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Formula_10_1",
        "x" : 1310,
        "y" : 648,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "CAST((CONCAT(MBR_HOME_ADDR_LN_1, ' ', MBR_HOME_ADDR_LN_2)) AS STRING)",
            "_row_id" : null
          },
          "alias" : "Address",
          "description" : null,
          "_row_id" : "OGu3Hhe4f3kpzfmAQuhUA"
        }, {
          "expression" : {
            "expression" : "*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "rQ38nzoaCnMxIyJ0KDJnQ",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "TYMlfwAHougjUT5X_Fqhx",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    },
    "29" : {
      "id" : "29",
      "component" : "VisualGroup",
      "metadata" : {
        "label" : "Step2",
        "x" : 1752,
        "y" : 0,
        "height" : 1620,
        "width" : 3726,
        "phase" : 0
      },
      "properties" : {
        "isCollapsed" : false
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ ]
      }
    },
    "3" : {
      "id" : "3",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "Sort_3",
        "x" : 530,
        "y" : 579,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "orders" : [ {
          "expression" : {
            "expression" : "MBR_INDV_BE_KEY",
            "_row_id" : null
          },
          "sortType" : "asc",
          "nullsType" : ""
        }, {
          "expression" : {
            "expression" : "ACTVTY_YR_MO_SK",
            "_row_id" : null
          },
          "sortType" : "asc",
          "nullsType" : ""
        }, {
          "expression" : {
            "expression" : "PROD_RANK",
            "_row_id" : null
          },
          "sortType" : "asc",
          "nullsType" : ""
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "3_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "3_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "6"
    },
    "28" : {
      "id" : "28",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_28",
        "x" : 410,
        "y" : 648,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "(MBR_RELSHP_CD <> 'DPNDT')",
          "_row_id" : null
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "28_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "28_True",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false
      },
      "parent" : "29"
    }
  },
  "connections" : [ {
    "id" : "edge_1",
    "source" : "1",
    "sourcePort" : "1_Output",
    "target" : "5",
    "targetPort" : "5_Input",
    "isWireless" : false
  }, {
    "id" : "edge_2",
    "source" : "3",
    "sourcePort" : "3_Output",
    "target" : "4",
    "targetPort" : "4_Input",
    "isWireless" : false
  }, {
    "id" : "edge_3",
    "source" : "4",
    "sourcePort" : "4_Unique",
    "target" : "28",
    "targetPort" : "28_Input",
    "isWireless" : false
  }, {
    "id" : "edge_4",
    "source" : "4",
    "sourcePort" : "4_Unique",
    "target" : "20",
    "targetPort" : "20_Input",
    "isWireless" : false
  }, {
    "id" : "edge_5",
    "source" : "4",
    "sourcePort" : "4_Unique",
    "target" : "24",
    "targetPort" : "24_Input",
    "isWireless" : false
  }, {
    "id" : "edge_6",
    "source" : "5",
    "sourcePort" : "5_True",
    "target" : "3",
    "targetPort" : "3_Input",
    "isWireless" : false
  }, {
    "id" : "edge_7",
    "source" : "9",
    "sourcePort" : "9_Output",
    "target" : "8",
    "targetPort" : "8_Input",
    "isWireless" : false
  }, {
    "id" : "edge_8",
    "source" : "11",
    "sourcePort" : "11_Output26",
    "target" : "12",
    "targetPort" : "12_Input",
    "isWireless" : false
  }, {
    "id" : "edge_9",
    "source" : "12",
    "sourcePort" : "12_Output",
    "target" : "13",
    "targetPort" : "13_Input",
    "isWireless" : false
  }, {
    "id" : "edge_10",
    "source" : "12",
    "sourcePort" : "12_Output",
    "target" : "19",
    "targetPort" : "19_Input",
    "isWireless" : false
  }, {
    "id" : "edge_11",
    "source" : "15",
    "sourcePort" : "15_Output",
    "target" : "17",
    "targetPort" : "17_Input",
    "isWireless" : false
  }, {
    "id" : "edge_12",
    "source" : "17",
    "sourcePort" : "17_True",
    "target" : "26",
    "targetPort" : "26_Input",
    "isWireless" : false
  }, {
    "id" : "edge_13",
    "source" : "28",
    "sourcePort" : "28_True",
    "target" : "9",
    "targetPort" : "9_Input",
    "isWireless" : false
  }, {
    "id" : "edge_14",
    "source" : "13",
    "sourcePort" : "13_True",
    "target" : "27",
    "targetPort" : "27_Input",
    "isWireless" : false
  }, {
    "id" : "edge_15",
    "source" : "13",
    "sourcePort" : "13_True",
    "target" : "27_reject",
    "targetPort" : "tFY46T-jApFGEWi6aEY4V",
    "isWireless" : false
  }, {
    "id" : "edge_16",
    "source" : "11",
    "sourcePort" : "11_Output26",
    "target" : "14_left",
    "targetPort" : "rqCI6Y5eAMGqk48Ay356W",
    "isWireless" : false
  }, {
    "id" : "edge_17",
    "source" : "13",
    "sourcePort" : "13_True",
    "target" : "14_left",
    "targetPort" : "QDJfzUyrzRq6W31SPmk1G",
    "isWireless" : false
  }, {
    "id" : "edge_18",
    "source" : "14_left",
    "sourcePort" : "ceNiJcDF9AXwcI5Xdov8T",
    "target" : "15",
    "targetPort" : "15_Input",
    "isWireless" : false
  }, {
    "id" : "edge_19",
    "source" : "14_left",
    "sourcePort" : "ceNiJcDF9AXwcI5Xdov8T",
    "target" : "25",
    "targetPort" : "25_Input",
    "isWireless" : false
  }, {
    "id" : "edge_20",
    "source" : "11",
    "sourcePort" : "11_Output26",
    "target" : "14_inner",
    "targetPort" : "tCYIgwudjitr4dXZgjtll",
    "isWireless" : false
  }, {
    "id" : "edge_21",
    "source" : "13",
    "sourcePort" : "13_True",
    "target" : "14_inner",
    "targetPort" : "OJR0Fa1UxWk44ea1dhlRg",
    "isWireless" : false
  }, {
    "id" : "edge_22",
    "source" : "14_inner",
    "sourcePort" : "4t6YT1emjXBmq-T0CsBHJ",
    "target" : "21",
    "targetPort" : "21_Input",
    "isWireless" : false
  }, {
    "id" : "edge_23",
    "source" : "17",
    "sourcePort" : "17_True",
    "target" : "23_inner",
    "targetPort" : "-qL1gljMRQiyV58-P1P-d",
    "isWireless" : false
  }, {
    "id" : "edge_24",
    "source" : "14_left",
    "sourcePort" : "ceNiJcDF9AXwcI5Xdov8T",
    "target" : "23_inner",
    "targetPort" : "xEYbLxacaGZp0QkPLJI54",
    "isWireless" : false
  }, {
    "id" : "edge_25",
    "source" : "23_inner",
    "sourcePort" : "10FgLhc3upH4qjJp36TMf",
    "target" : "22",
    "targetPort" : "22_Input",
    "isWireless" : false
  }, {
    "id" : "edge_26",
    "source" : "zKwCG-hYIWgqx_x25-PE3",
    "sourcePort" : "gZBQ_BtGltV00RDp3rjY7",
    "target" : "2swA5FhFWpHamb-DJJNu4",
    "targetPort" : "rQ38nzoaCnMxIyJ0KDJnQ",
    "isWireless" : false
  }, {
    "id" : "edge_27",
    "source" : "2swA5FhFWpHamb-DJJNu4",
    "sourcePort" : "TYMlfwAHougjUT5X_Fqhx",
    "target" : "11",
    "targetPort" : "11_Input2",
    "isWireless" : false
  }, {
    "id" : "edge_28",
    "source" : "8",
    "sourcePort" : "8_Output",
    "target" : "zKwCG-hYIWgqx_x25-PE3",
    "targetPort" : "DOYhWclmJVN4K0lbcwCj7",
    "isWireless" : false
  }, {
    "id" : "edge_29",
    "source" : "5hJZ_5S8_ULGU9U8tXxu_",
    "sourcePort" : "_WZovEnkdmPdmUeWL_9DB",
    "target" : "18",
    "targetPort" : "18_Input",
    "isWireless" : false
  }, {
    "id" : "edge_30",
    "source" : "17",
    "sourcePort" : "17_True",
    "target" : "5hJZ_5S8_ULGU9U8tXxu_",
    "targetPort" : "SuR-J6AFdoPkagC2cqZW0",
    "isWireless" : false
  }, {
    "id" : "edge_31",
    "source" : "kbj_P1-55w8eZIhBMcpoJ",
    "sourcePort" : "uQBZJqOr7ZT0FSIa6qvIz",
    "target" : "2",
    "targetPort" : "2_Input",
    "isWireless" : false
  }, {
    "id" : "edge_32",
    "source" : "4",
    "sourcePort" : "4_Unique",
    "target" : "kbj_P1-55w8eZIhBMcpoJ",
    "targetPort" : "I4T_n8y3DbrfZA-Fjke7V",
    "isWireless" : false
  } ],
  "component" : "Pipeline"
}
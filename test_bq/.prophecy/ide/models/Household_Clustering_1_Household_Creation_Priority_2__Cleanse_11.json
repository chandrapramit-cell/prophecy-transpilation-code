{
  "id" : "Household_Clustering_1_Household_Creation_Priority_2__Cleanse_11",
  "metainfo" : {
    "label" : "Household_Clustering_1_Household_Creation_Priority_2__Cleanse_11",
    "autoLayout" : true,
    "staleState" : "none",
    "sourceSuggestions" : {
      "sources" : [ ]
    },
    "graphConfig" : {
      "entityConfig" : {
        "materialized" : "ephemeral",
        "database" : "\"prophecy-databricks-qa\"",
        "schema" : "\"qa_test_dataset\"",
        "type" : "ModelConfig"
      }
    },
    "version" : 3
  },
  "processes" : {
    "8" : {
      "id" : "8",
      "component" : "OrderBy",
      "metadata" : {
        "label" : "Sort_8",
        "x" : 890,
        "y" : 651,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "orders" : [ {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_1",
            "_row_id" : null
          },
          "sortType" : "asc",
          "nullsType" : ""
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_2",
            "_row_id" : null
          },
          "sortType" : "asc",
          "nullsType" : ""
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "sortType" : "asc",
          "nullsType" : ""
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "8_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "8_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "zKwCG-hYIWgqx_x25-PE3" : {
      "id" : "zKwCG-hYIWgqx_x25-PE3",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Formula_10_0",
        "x" : 1130,
        "y" : 648,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "CAST((CASE WHEN (MBR_HOME_ADDR_LN_1 IS NULL) THEN '' ELSE MBR_HOME_ADDR_LN_1 END) AS STRING)",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_1",
          "description" : null,
          "_row_id" : "Pt7vDL_r0RZvxKmCFVvsh"
        }, {
          "expression" : {
            "expression" : "CAST((CASE WHEN (MBR_HOME_ADDR_LN_2 IS NULL) THEN '' ELSE MBR_HOME_ADDR_LN_2 END) AS STRING)",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_2",
          "description" : null,
          "_row_id" : "dSphOU3GiFNsyYC6Qv_zx"
        }, {
          "expression" : {
            "expression" : "* EXCEPT(`mbr_home_addr_ln_2`, `mbr_home_addr_ln_1`)",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "DOYhWclmJVN4K0lbcwCj7",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "gZBQ_BtGltV00RDp3rjY7",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "11" : {
      "id" : "11",
      "component" : "DataCleansing",
      "metadata" : {
        "label" : "Cleanse_11",
        "x" : 1550,
        "y" : 651,
        "phase" : 0
      },
      "properties" : {
        "trimWhiteSpace" : true,
        "replaceNullForNumericFields" : true,
        "cleanLetters" : false,
        "replaceNullTextWith" : "",
        "removeRowNullAllCols" : false,
        "replaceNullTextFields" : true,
        "relation_name" : [ "Formula_10_1" ],
        "replaceNullDateWith" : "1970-01-01",
        "columnNames" : [ "MBR_HOME_ADDR_LN_1", "MBR_HOME_ADDR_LN_2", "MBR_HOME_ADDR_CITY_NM", "MBR_HOME_ADDR_ST_CD", "MBR_HOME_ADDR_CNTY_NM", "MBR_HOME_ADDR_ZIP_CD_5", "ACTVTY_YR_MO_SK", "MBR_INDV_BE_KEY", "Address" ],
        "replaceNullTimeFields" : false,
        "_oldMacroProperties" : {
          "macroName" : "DataCleansing",
          "projectName" : "prophecy_basics",
          "parameters" : [ {
            "name" : "relation_name",
            "value" : "[\"Formula_10_1\"]"
          }, {
            "name" : "schema",
            "value" : "[{\"name\": \"Address\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_LN_1\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_LN_2\", \"dataType\": \"String\"}, {\"name\": \"MBR_INDV_BE_KEY\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_CITY_NM\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_ZIP_CD_5\", \"dataType\": \"String\"}, {\"name\": \"ACTVTY_YR_MO_SK\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_CNTY_NM\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_ST_CD\", \"dataType\": \"String\"}]"
          }, {
            "name" : "modifyCase",
            "value" : "keepOriginal"
          }, {
            "name" : "columnNames",
            "value" : "[\"MBR_HOME_ADDR_LN_1\", \"MBR_HOME_ADDR_LN_2\", \"MBR_HOME_ADDR_CITY_NM\", \"MBR_HOME_ADDR_ST_CD\", \"MBR_HOME_ADDR_CNTY_NM\", \"MBR_HOME_ADDR_ZIP_CD_5\", \"ACTVTY_YR_MO_SK\", \"MBR_INDV_BE_KEY\", \"Address\"]"
          }, {
            "name" : "replaceNullTextFields",
            "value" : "true"
          }, {
            "name" : "replaceNullTextWith",
            "value" : ""
          }, {
            "name" : "replaceNullForNumericFields",
            "value" : "true"
          }, {
            "name" : "replaceNullNumericWith",
            "value" : "0"
          }, {
            "name" : "trimWhiteSpace",
            "value" : "true"
          }, {
            "name" : "removeTabsLineBreaksAndDuplicateWhitespace",
            "value" : "true"
          }, {
            "name" : "allWhiteSpace",
            "value" : "false"
          }, {
            "name" : "cleanLetters",
            "value" : "false"
          }, {
            "name" : "cleanPunctuations",
            "value" : "false"
          }, {
            "name" : "cleanNumbers",
            "value" : "false"
          }, {
            "name" : "removeRowNullAllCols",
            "value" : "false"
          }, {
            "name" : "replaceNullDateFields",
            "value" : "false"
          }, {
            "name" : "replaceNullDateWith",
            "value" : "1970-01-01"
          }, {
            "name" : "replaceNullTimeFields",
            "value" : "false"
          }, {
            "name" : "replaceNullTimeWith",
            "value" : "1970-01-01 00:00:00.0"
          } ]
        },
        "replaceNullTimeWith" : "1970-01-01 00:00:00.0",
        "schema" : "[{\"name\": \"Address\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_LN_1\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_LN_2\", \"dataType\": \"String\"}, {\"name\": \"MBR_INDV_BE_KEY\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_CITY_NM\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_ZIP_CD_5\", \"dataType\": \"String\"}, {\"name\": \"ACTVTY_YR_MO_SK\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_CNTY_NM\", \"dataType\": \"String\"}, {\"name\": \"MBR_HOME_ADDR_ST_CD\", \"dataType\": \"String\"}]",
        "allWhiteSpace" : false,
        "removeTabsLineBreaksAndDuplicateWhitespace" : true,
        "modifyCase" : "keepOriginal",
        "cleanPunctuations" : false,
        "replaceNullDateFields" : false,
        "cleanNumbers" : false,
        "replaceNullNumericWith" : 0
      },
      "ports" : {
        "inputs" : [ {
          "id" : "11_Input2",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "11_Output26",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "9" : {
      "id" : "9",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Summarize_9",
        "x" : 650,
        "y" : 612,
        "phase" : 0
      },
      "properties" : {
        "dedupColumns" : [ {
          "expression" : {
            "expression" : "MBR_INDV_BE_KEY",
            "_row_id" : null
          },
          "alias" : "MBR_INDV_BE_KEY",
          "description" : null,
          "_row_id" : "VmGttfyd3djrcOjuhUdxD"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CITY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CITY_NM",
          "description" : null,
          "_row_id" : "A978SF6w1AicePpLXKCoW"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_2",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_2",
          "description" : null,
          "_row_id" : "YgAMLOxRv6rphaO8AyxRV"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ZIP_CD_5",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ZIP_CD_5",
          "description" : null,
          "_row_id" : "kAMLjwoY8JAEzvRoGtQrx"
        }, {
          "expression" : {
            "expression" : "ACTVTY_YR_MO_SK",
            "_row_id" : null
          },
          "alias" : "ACTVTY_YR_MO_SK",
          "description" : null,
          "_row_id" : "w2mcgkchnKbZ_G5MEwDN5"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_CNTY_NM",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_CNTY_NM",
          "description" : null,
          "_row_id" : "MKvIDKk_3RHzoLLwUev6C"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_LN_1",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_LN_1",
          "description" : null,
          "_row_id" : "W_f8XAe8gM2qVkCB-uH4p"
        }, {
          "expression" : {
            "expression" : "MBR_HOME_ADDR_ST_CD",
            "_row_id" : null
          },
          "alias" : "MBR_HOME_ADDR_ST_CD",
          "description" : null,
          "_row_id" : "uATSib2LK6K5FMURRpVW2"
        } ],
        "dedupType" : "distinct"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "9_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "9_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "2swA5FhFWpHamb-DJJNu4" : {
      "id" : "2swA5FhFWpHamb-DJJNu4",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Formula_10_1",
        "x" : 1310,
        "y" : 648,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "CAST((CONCAT(MBR_HOME_ADDR_LN_1, ' ', MBR_HOME_ADDR_LN_2)) AS STRING)",
            "_row_id" : null
          },
          "alias" : "Address",
          "description" : null,
          "_row_id" : "OGu3Hhe4f3kpzfmAQuhUA"
        }, {
          "expression" : {
            "expression" : "*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "rQ38nzoaCnMxIyJ0KDJnQ",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "TYMlfwAHougjUT5X_Fqhx",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "Cleanse_11_11_Output26" : {
      "id" : "Cleanse_11_11_Output26",
      "component" : "TargetModel",
      "metadata" : {
        "label" : "Cleanse_11"
      },
      "properties" : {
        "customQueryDisabled" : true,
        "customQuery" : false,
        "incrementalEditorDisabled" : true,
        "query" : "\nSELECT *\n\nFROM Cleanse_11\n\n",
        "isModel" : true,
        "incrementalKey" : false,
        "incremental" : {
          "expression" : "true"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "input_port_5",
          "slug" : "input_port_5"
        } ],
        "outputs" : [ {
          "id" : "output_port_5",
          "slug" : "output_port_5"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "Unique_4_4_Unique" : {
      "id" : "Unique_4_4_Unique",
      "component" : "SQLStatement",
      "metadata" : {
        "label" : "Unique_4"
      },
      "properties" : {
        "fileTabs" : [ {
          "path" : "output_port_1",
          "id" : "output_port_1",
          "language" : "sql",
          "content" : "\nSELECT *\n\nFROM {{ ref('Household_Clustering_1_Household_Creation_Priority_2__Unique_4') }}\n\n"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "input_port_1",
          "slug" : "input_port_1"
        } ],
        "outputs" : [ {
          "id" : "output_port_1",
          "slug" : "output_port_1"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "28" : {
      "id" : "28",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_28",
        "x" : 410,
        "y" : 648,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "(MBR_RELSHP_CD <> 'DPNDT')",
          "_row_id" : null
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "28_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "28_True",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    }
  },
  "connections" : [ {
    "id" : "conn_11_11_Output26_Cleanse_11_11_Output26",
    "source" : "11",
    "sourcePort" : "11_Output26",
    "target" : "Cleanse_11_11_Output26",
    "targetPort" : "input_port_5",
    "isWireless" : false
  }, {
    "id" : "edge_27",
    "source" : "2swA5FhFWpHamb-DJJNu4",
    "sourcePort" : "TYMlfwAHougjUT5X_Fqhx",
    "target" : "11",
    "targetPort" : "11_Input2",
    "isWireless" : false
  }, {
    "id" : "edge_26",
    "source" : "zKwCG-hYIWgqx_x25-PE3",
    "sourcePort" : "gZBQ_BtGltV00RDp3rjY7",
    "target" : "2swA5FhFWpHamb-DJJNu4",
    "targetPort" : "rQ38nzoaCnMxIyJ0KDJnQ",
    "isWireless" : false
  }, {
    "id" : "edge_28",
    "source" : "8",
    "sourcePort" : "8_Output",
    "target" : "zKwCG-hYIWgqx_x25-PE3",
    "targetPort" : "DOYhWclmJVN4K0lbcwCj7",
    "isWireless" : false
  }, {
    "id" : "edge_7",
    "source" : "9",
    "sourcePort" : "9_Output",
    "target" : "8",
    "targetPort" : "8_Input",
    "isWireless" : false
  }, {
    "id" : "edge_13",
    "source" : "28",
    "sourcePort" : "28_True",
    "target" : "9",
    "targetPort" : "9_Input",
    "isWireless" : false
  }, {
    "id" : "edge_3",
    "source" : "Unique_4_4_Unique",
    "sourcePort" : "output_port_1",
    "target" : "28",
    "targetPort" : "28_Input",
    "isWireless" : false
  } ],
  "component" : "Model"
}
{
  "id" : "Focus_Pages_MVP_Priority_2__Formula_102_1",
  "metainfo" : {
    "label" : "Focus_Pages_MVP_Priority_2__Formula_102_1",
    "autoLayout" : true,
    "staleState" : "none",
    "sourceSuggestions" : {
      "sources" : [ ]
    },
    "graphConfig" : {
      "entityConfig" : {
        "materialized" : "ephemeral",
        "database" : "\"prophecy-databricks-qa\"",
        "schema" : "\"qa_test_dataset\"",
        "type" : "ModelConfig"
      }
    },
    "version" : 3
  },
  "processes" : {
    "Formula_102_1_jHq8U2BKNUzRZiWcT109S" : {
      "id" : "Formula_102_1_jHq8U2BKNUzRZiWcT109S",
      "component" : "TargetModel",
      "metadata" : {
        "label" : "Formula_102_1"
      },
      "properties" : {
        "customQueryDisabled" : true,
        "customQuery" : false,
        "incrementalEditorDisabled" : true,
        "query" : "\nSELECT *\n\nFROM Formula_102_1\n\n",
        "isModel" : true,
        "incrementalKey" : false,
        "incremental" : {
          "expression" : "true"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "input_port_6",
          "slug" : "input_port_6"
        } ],
        "outputs" : [ {
          "id" : "output_port_6",
          "slug" : "output_port_6"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "s48t4cNPnYPe-m2nnai_H" : {
      "id" : "s48t4cNPnYPe-m2nnai_H",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Formula_102_1",
        "x" : 4310,
        "y" : 1374,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "(CASE WHEN (Trimester = 'First Trimester') THEN 1 WHEN (Trimester = 'Second Trimester') THEN 2 WHEN (Trimester = 'Third Trimester') THEN 3 ELSE 0 END)",
            "_row_id" : null
          },
          "alias" : "Trimester_INT",
          "description" : null,
          "_row_id" : "j6oa9n8IT95rhJ2gANi4F"
        }, {
          "expression" : {
            "expression" : "*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "5XXnsekYDqCvXxxXIwjRI",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "jHq8U2BKNUzRZiWcT109S",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "vdHRSIeR8qUlPab1tvyGX" : {
      "id" : "vdHRSIeR8qUlPab1tvyGX",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Formula_102_0",
        "x" : 4130,
        "y" : 1374,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "CAST((\n  CASE\n    WHEN (\n      (CAST(PregnancyDiag AS VARCHAR (1000)) IN ('Z3401', 'Z3481', 'Z3491'))\n      OR (\n           CAST(PregnancyDiag AS VARCHAR (1000)) IN (\n             'O99211',\n             'O99281',\n             'O99611',\n             'O99511',\n             'O99341',\n             'O99011',\n             'O99411',\n             'O98511',\n             'O99351',\n             'O9A211',\n             'O98811',\n             'O99331',\n             'O99111',\n             'O99321',\n             'O99841',\n             'O91111',\n             'O98311',\n             'O99711',\n             'O98111',\n             'O98211',\n             'O98911',\n             'O9A311',\n             'O99311',\n             'O91211',\n             'O26891',\n             'O26851',\n             'O2341',\n             'O24111',\n             'O2621',\n             'O26841',\n             'O2691',\n             'O24011',\n             'O2311',\n             'O23591',\n             'O26811',\n             'O2231',\n             'O26611',\n             'O24911',\n             'O2391',\n             'O2611',\n             'O24311',\n             'O2331',\n             'O23511',\n             'O2941',\n             'O2651',\n             'O26821',\n             'O29211',\n             'O26831',\n             'O2631'\n           )\n         )\n    )\n      THEN 'First Trimester'\n    WHEN (\n      (CAST(PregnancyDiag AS VARCHAR (1000)) IN ('Z3402', 'Z3482', 'Z3492'))\n      OR (\n           CAST(PregnancyDiag AS VARCHAR (1000)) IN (\n             'O99212',\n             'O99282',\n             'O99342',\n             'O99512',\n             'O99612',\n             'O99012',\n             'O99352',\n             'O98512',\n             'O9A212',\n             'O99412',\n             'O99112',\n             'O9A112',\n             'O99842',\n             'O99712',\n             'O99332',\n             'O99322',\n             'O98112',\n             'O98812',\n             'O98312',\n             'O9A312',\n             'O98412',\n             'O99312',\n             'O98912',\n             'O26892',\n             'O2342',\n             'O24112',\n             'O26872',\n             'O24012',\n             'O2622',\n             'O26852',\n             'O26832',\n             'O2312',\n             'O2302',\n             'O23592',\n             'O26812',\n             'O26612',\n             'O24912',\n             'O26842',\n             'O2692',\n             'O26712',\n             'O24312',\n             'O24812',\n             'O2612',\n             'O2242',\n             'O2392',\n             'O2332',\n             'O2232',\n             'O26642',\n             'O26822',\n             'O2602'\n           )\n         )\n    )\n      THEN 'Second Trimester'\n    WHEN (\n      (CAST(PregnancyDiag AS VARCHAR (1000)) IN ('Z3403', 'Z3483', 'Z3493'))\n      OR (\n           CAST(PregnancyDiag AS VARCHAR (1000)) IN (\n             'O99213',\n             'O99013',\n             'O99283',\n             'O98513',\n             'O99343',\n             'O99413',\n             'O99513',\n             'O99113',\n             'O99613',\n             'O9A213',\n             'O99353',\n             'O99713',\n             'O99843',\n             'O99333',\n             'O99323',\n             'O9A113',\n             'O98813',\n             'O98313',\n             'O98113',\n             'O91113',\n             'O98413',\n             'O99313',\n             'O98913',\n             'O26893',\n             'O24113',\n             'O24013',\n             'O26613',\n             'O26843',\n             'O2693',\n             'O2343',\n             'O26853',\n             'O2303',\n             'O26873',\n             'O2623',\n             'O24913',\n             'O23593',\n             'O26833',\n             'O2613',\n             'O2233',\n             'O26643',\n             'O24813',\n             'O2653',\n             'O26813',\n             'O2203',\n             'O2603',\n             'O2243',\n             'O2313',\n             'O2393',\n             'O2293',\n             'O24313',\n             'O228X3',\n             'O2333',\n             'O2943'\n           )\n         )\n    )\n      THEN 'Third Trimester'\n    WHEN (\n      (CAST((SUBSTRING(PregnancyDiag, 1, 3)) AS VARCHAR (1000)) IN ('Z34'))\n      OR CAST(((STRPOS((coalesce(LOWER(LOWER(PregnancyDiagDesc)), '')), LOWER('unspecified trimester'))) > 0) AS BOOLEAN)\n    )\n      THEN 'Unspecified Trimester'\n    ELSE 'Error'\n  END\n) AS VARCHAR (1000))",
            "_row_id" : null
          },
          "alias" : "Trimester",
          "description" : null,
          "_row_id" : "COIPZ2EK_8XU516knni_Q"
        }, {
          "expression" : {
            "expression" : "*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "kbw32pwyYGA-EDPdJLyl5",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "1ZtE6xPa9Dhu2ywUSS378",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "Formula_90_0_nhcNz326QhpJl7nnxnquu" : {
      "id" : "Formula_90_0_nhcNz326QhpJl7nnxnquu",
      "component" : "SQLStatement",
      "metadata" : {
        "label" : "Formula_90_0"
      },
      "properties" : {
        "fileTabs" : [ {
          "path" : "output_port_5",
          "id" : "output_port_5",
          "language" : "sql",
          "content" : "\nSELECT *\n\nFROM {{ ref('Focus_Pages_MVP_Priority_2__Formula_90_0') }}\n\n"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "input_port_5",
          "slug" : "input_port_5"
        } ],
        "outputs" : [ {
          "id" : "output_port_5",
          "slug" : "output_port_5"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    }
  },
  "connections" : [ {
    "id" : "conn_s48t4cNPnYPe-m2nnai_H_jHq8U2BKNUzRZiWcT109S_Formula_102_1_jHq8U2BKNUzRZiWcT109S",
    "source" : "s48t4cNPnYPe-m2nnai_H",
    "sourcePort" : "jHq8U2BKNUzRZiWcT109S",
    "target" : "Formula_102_1_jHq8U2BKNUzRZiWcT109S",
    "targetPort" : "input_port_6",
    "isWireless" : false
  }, {
    "id" : "edge_281",
    "source" : "vdHRSIeR8qUlPab1tvyGX",
    "sourcePort" : "1ZtE6xPa9Dhu2ywUSS378",
    "target" : "s48t4cNPnYPe-m2nnai_H",
    "targetPort" : "5XXnsekYDqCvXxxXIwjRI",
    "isWireless" : false
  }, {
    "id" : "edge_284",
    "source" : "Formula_90_0_nhcNz326QhpJl7nnxnquu",
    "sourcePort" : "output_port_5",
    "target" : "vdHRSIeR8qUlPab1tvyGX",
    "targetPort" : "kbw32pwyYGA-EDPdJLyl5",
    "isWireless" : false
  } ],
  "component" : "Model"
}
{
  "id" : "Focus_Pages_MVP_Priority_2__Unique_125",
  "metainfo" : {
    "label" : "Focus_Pages_MVP_Priority_2__Unique_125",
    "autoLayout" : true,
    "staleState" : "none",
    "sourceSuggestions" : {
      "sources" : [ ]
    },
    "graphConfig" : {
      "entityConfig" : {
        "materialized" : "ephemeral",
        "database" : "\"prophecy-databricks-qa\"",
        "schema" : "\"qa_test_dataset\"",
        "type" : "ModelConfig"
      }
    },
    "version" : 3
  },
  "processes" : {
    "124" : {
      "id" : "124",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_124",
        "x" : 3170,
        "y" : 3678,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "MBR_SK",
            "_row_id" : null
          },
          "alias" : "MBR_SK",
          "description" : null,
          "_row_id" : "ZRSYQFdK0g3thMR_QkG51"
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "124_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "124_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "117" : {
      "id" : "117",
      "component" : "Reformat",
      "metadata" : {
        "label" : "AlteryxSelect_117",
        "x" : 1730,
        "y" : 3750,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "(CASE WHEN (SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%E3%f%f', CAST(`Service Date` AS string)) IS NOT NULL) THEN CAST(SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%E3%f%f', CAST(`Service Date` AS string)) AS DATE) WHEN (SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%%f', CAST(`Service Date` AS string)) IS NOT NULL) THEN CAST(SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%%f', CAST(`Service Date` AS string)) AS DATE) ELSE CAST(SAFE.PARSE_TIMESTAMP('%Y-%m-%d', CAST(`Service Date` AS string)) AS DATE) END)",
            "_row_id" : null
          },
          "alias" : "`Service Date`",
          "description" : null,
          "_row_id" : "Zoo7Bz_ByMMfP1iYF_AO6"
        }, {
          "expression" : {
            "expression" : "(CASE WHEN (SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%E3%f%f', CAST(YEARMONTH AS string)) IS NOT NULL) THEN CAST(SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%E3%f%f', CAST(YEARMONTH AS string)) AS DATE) WHEN (SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%%f', CAST(YEARMONTH AS string)) IS NOT NULL) THEN CAST(SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%%f', CAST(YEARMONTH AS string)) AS DATE) ELSE CAST(SAFE.PARSE_TIMESTAMP('%Y-%m-%d', CAST(YEARMONTH AS string)) AS DATE) END)",
            "_row_id" : null
          },
          "alias" : "YEARMONTH",
          "description" : null,
          "_row_id" : "mjKjZVvYST65tNwGN77JT"
        }, {
          "expression" : {
            "expression" : "* EXCEPT(`Service Date`, `YEARMONTH`)",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "117_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "117_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "123" : {
      "id" : "123",
      "component" : "Filter",
      "metadata" : {
        "label" : "Filter_123",
        "x" : 2450,
        "y" : 3714,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "condition" : {
          "expression" : "(\n  (\n    (\n      (CAST((SUBSTRING(DIAG_CD, 1, 3)) AS VARCHAR (1000)) IN ('Z332', 'O03', 'O04'))\n      OR (\n           CAST(PROC_CD AS VARCHAR (1000)) IN (\n             '59515',\n             '59514',\n             '59510',\n             '59400',\n             '59409',\n             '59410',\n             '59610',\n             '59612',\n             '59614',\n             '59409',\n             '59612',\n             '59618',\n             '59620',\n             '59622',\n             '59620',\n             '59409',\n             '59612',\n             'J7296',\n             'J7297',\n             'J7298',\n             'J7300',\n             'J7301',\n             'J1050'\n           )\n         )\n    )\n    OR CAST(((STRPOS((coalesce(LOWER(LOWER(PROC_CD_DESC)), '')), LOWER('salpingectomy'))) > 0) AS BOOLEAN)\n  )\n  OR CAST(((STRPOS((coalesce(LOWER(LOWER(PROC_CD_DESC)), '')), LOWER('oophorectomy'))) > 0) AS BOOLEAN)\n)",
          "_row_id" : null
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "123_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "123_True",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "121_inner" : {
      "id" : "121_inner",
      "component" : "Join",
      "metadata" : {
        "label" : "Join_121_inner",
        "x" : 1250,
        "y" : 3747,
        "phase" : 0
      },
      "properties" : {
        "conditions" : [ {
          "alias" : "in1",
          "expression" : {
            "expression" : "(in0.DIAG_CD_1_SK = in1.DIAG_CD_SK)",
            "_row_id" : null
          },
          "joinType" : "inner",
          "rightAlias" : null
        } ],
        "allowSelection" : false,
        "expressions" : [ {
          "expression" : {
            "expression" : "in0.*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        }, {
          "expression" : {
            "expression" : "in1.* EXCEPT(`DIAG_CD_SK`)",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ],
        "activeTab" : "conditions",
        "columnsSelector" : [ ],
        "headAlias" : "in0"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "dbtnWExemR9V69awD5SwR",
          "slug" : "in0"
        }, {
          "id" : "61ssVzPD3XZNeqb5Kyu6K",
          "slug" : "in1"
        } ],
        "outputs" : [ {
          "id" : "uPp55yuIPgdf4YHOb6WPC",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "116" : {
      "id" : "116",
      "component" : "Source",
      "metadata" : {
        "label" : "aka_alxaa2_Quer_116",
        "x" : 290,
        "y" : 3351,
        "phase" : 0
      },
      "properties" : {
        "table" : {
          "name" : "aka_alxaa2_Quer_116_ref",
          "sourceType" : "Table",
          "sourceName" : "transpiled_sources",
          "alias" : ""
        },
        "writeOptions" : {
          "writeMode" : "overwrite"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "116_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "Unique_125_125_Unique" : {
      "id" : "Unique_125_125_Unique",
      "component" : "TargetModel",
      "metadata" : {
        "label" : "Unique_125"
      },
      "properties" : {
        "customQueryDisabled" : true,
        "customQuery" : false,
        "incrementalEditorDisabled" : true,
        "query" : "\nSELECT *\n\nFROM Unique_125\n\n",
        "isModel" : true,
        "incrementalKey" : false,
        "incremental" : {
          "expression" : "true"
        }
      },
      "ports" : {
        "inputs" : [ {
          "id" : "input_port_4",
          "slug" : "input_port_4"
        } ],
        "outputs" : [ {
          "id" : "output_port_4",
          "slug" : "output_port_4"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "q8QTknH3DSu5uhCEI_1zY" : {
      "id" : "q8QTknH3DSu5uhCEI_1zY",
      "component" : "Reformat",
      "metadata" : {
        "label" : "Formula_118_0",
        "x" : 530,
        "y" : 3354,
        "phase" : 0
      },
      "properties" : {
        "columnsSelector" : [ ],
        "expressions" : [ {
          "expression" : {
            "expression" : "CAST((CONCAT((SUBSTRING( `Service Date`, 1, 7)), '-01')) AS STRING)",
            "_row_id" : null
          },
          "alias" : "YEARMONTH",
          "description" : null,
          "_row_id" : "UZm_HJRDMS-VnAjIopvKv"
        }, {
          "expression" : {
            "expression" : "*",
            "_row_id" : null
          },
          "alias" : null,
          "description" : null,
          "_row_id" : null
        } ]
      },
      "ports" : {
        "inputs" : [ {
          "id" : "AECdfG8mBaiuUXiLwe6DB",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "t34jN36IEdgKSikOFHLm3",
          "slug" : "out"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "125" : {
      "id" : "125",
      "component" : "Deduplicate",
      "metadata" : {
        "label" : "Unique_125",
        "x" : 4130,
        "y" : 3678,
        "phase" : 0
      },
      "properties" : {
        "dedupColumns" : [ {
          "expression" : {
            "expression" : "MBR_SK",
            "_row_id" : null
          },
          "alias" : "MBR_SK",
          "description" : null,
          "_row_id" : "7RqMXOmtEoy3JWkl5V2TH"
        } ],
        "dedupType" : "first"
      },
      "ports" : {
        "inputs" : [ {
          "id" : "125_Input",
          "slug" : "in0"
        } ],
        "outputs" : [ {
          "id" : "125_Unique",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    },
    "119" : {
      "id" : "119",
      "component" : "Source",
      "metadata" : {
        "label" : "aka_alxaa2_Quer_119",
        "x" : 290,
        "y" : 3999,
        "phase" : 0
      },
      "properties" : {
        "table" : {
          "name" : "aka_alxaa2_Quer_119_ref",
          "sourceType" : "Table",
          "sourceName" : "transpiled_sources",
          "alias" : ""
        },
        "writeOptions" : {
          "writeMode" : "overwrite"
        }
      },
      "ports" : {
        "inputs" : [ ],
        "outputs" : [ {
          "id" : "119_Output",
          "slug" : "out0"
        } ],
        "isCustomOutputSchema" : false,
        "autoUpdateOnRun" : false
      }
    }
  },
  "connections" : [ {
    "id" : "conn_125_125_Unique_Unique_125_125_Unique",
    "source" : "125",
    "sourcePort" : "125_Unique",
    "target" : "Unique_125_125_Unique",
    "targetPort" : "input_port_4",
    "isWireless" : false
  }, {
    "id" : "edge_184",
    "source" : "124",
    "sourcePort" : "124_Output",
    "target" : "125",
    "targetPort" : "125_Input",
    "isWireless" : false
  }, {
    "id" : "edge_183",
    "source" : "123",
    "sourcePort" : "123_True",
    "target" : "124",
    "targetPort" : "124_Input",
    "isWireless" : false
  }, {
    "id" : "edge_181",
    "source" : "117",
    "sourcePort" : "117_Output",
    "target" : "123",
    "targetPort" : "123_Input",
    "isWireless" : false
  }, {
    "id" : "edge_238",
    "source" : "121_inner",
    "sourcePort" : "uPp55yuIPgdf4YHOb6WPC",
    "target" : "117",
    "targetPort" : "117_Input",
    "isWireless" : false
  }, {
    "id" : "edge_246",
    "source" : "119",
    "sourcePort" : "119_Output",
    "target" : "121_inner",
    "targetPort" : "61ssVzPD3XZNeqb5Kyu6K",
    "isWireless" : false
  }, {
    "id" : "edge_273",
    "source" : "q8QTknH3DSu5uhCEI_1zY",
    "sourcePort" : "t34jN36IEdgKSikOFHLm3",
    "target" : "121_inner",
    "targetPort" : "dbtnWExemR9V69awD5SwR",
    "isWireless" : false
  }, {
    "id" : "edge_274",
    "source" : "116",
    "sourcePort" : "116_Output",
    "target" : "q8QTknH3DSu5uhCEI_1zY",
    "targetPort" : "AECdfG8mBaiuUXiLwe6DB",
    "isWireless" : false
  } ],
  "component" : "Model"
}